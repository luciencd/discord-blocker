notes:


So Discord connections to the outside world can be listed via 
lsof -i -p | grep discord

They are TCP and UDP connections that are opened by the discord process

If you create a firewall in /etc/pf.conf, you can block those connections and cause discord to not work


So if then you create a python file to enable or disable that set of rules, you can on a timer, disable or reenable discord (or any other app assu)


so

block drop out quick on en0 proto {tcp udp} to 162.159.136.234
block drop out quick on en0 proto {tcp udp} to 162.159.128.232
block drop out quick on en0 proto {tcp udp} to 162.159.138.232
block drop out quick on en0 proto {tcp udp} to 162.159.134.233
block drop out quick on en0 proto {tcp udp} to 162.159.137.232
block drop out quick on en0 proto {tcp udp} to 162.159.128.233
block drop out quick on en0 proto {tcp udp} to 162.159.133.234


so we can create another file that has the custom rules so i dont break some default rule in the main config /etc/pf.config




Then we can reference a new file pf.discord.table in pf.discord.config

table <discord_servers> persist file "/etc/pf.discord.table"

block drop out quick on en0 proto {tcp udp} to <discord_servers>


we can call it pf.discord.table:
162.159.136.234
162.159.128.232
162.159.138.232
162.159.134.233
162.159.137.232
162.159.128.233
162.159.133.234







sudo lsof -i -n -P | grep Discord | awk '{print $9}' | awk -F '->' '{print $2}' | awk -F ':' '{print $1}' | sort -u > 

^ this will get the unique list of ips that are connected to the discord process , so if we want to dynamically add it to pf.discord.table so it can be used by the ruleset


sudo lsof -i -n -P | grep Discord | awk '{print $9}' | awk -F '->' '{print $2}' | awk -F ':' '{print $1}' | sort -u | sudo tee /etc/pf.discord.table > /dev/null

ok now lets see if i can then run this command, alongside the command for resetting the ruleset at regular intervals so that i can always have discord be blocked from midnight to 9 am


adding this to crontab:

crontab -l (lists all cron jobs)

crontab -e (open's users cron jobs for editing)

add 
`$ * * * * * /Users/lucien/Dropbox/Code/discordblocker/live_discord_firewall.sh >> /Users/lucien/Dropbox/Code/discordblocker/blocker.log 2>&1`

sudo crontab -e


